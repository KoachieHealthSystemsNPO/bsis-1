<databaseChangeLog xmlns="http://www.liquibase.org/xml/ns/dbchangelog"
	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:ext="http://www.liquibase.org/xml/ns/dbchangelog-ext"
	xsi:schemaLocation="http://www.liquibase.org/xml/ns/dbchangelog http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-2.0.xsd
        http://www.liquibase.org/xml/ns/dbchangelog-ext http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-ext.xsd">

	<!-- NEVER DELETE OR MODIFY EXISTING CHANGE SETS - instead add change sets 
		reversing the previous ones if you need to change or delete -->
	<!-- ALWAYS USE A UNIQUE IDENTIFIER of format id="yyyy-mm-dd-<n>" eg: id="2010-12-07-1" -->
	<!-- ALWAYS UPDATE YOUR LOCAL COPY FROM SVN AND THEN VERIFY YOUR id BASED 
		ON THAT LATEST VERSION -->

	<!-- NEVER EVER FORMAT THIS FILE -->
	<!-- ALWAYS FORMAT YOUR ID IN YYYY-MM-DD-XX -->
	<!-- NEVER ENTER SINGLE DIGIT MONTH / YEAR / COUNTER. ALWAYS USE 2 DIGITS 
		SO THAT ORDER BY THIS ID IS ALWAYS PROPER -->
	<!-- "2012-05-05-01" < "2012-1-1-1" - WHICH IS DB WISE CORRECT, BUT INVALID 
		AS SUCH, BUT "2012-05-05-01" > "2012-01-01-01" WHICH IS VALID FOR BOTH DB 
		AS WELL AS CHRONOLOGICALLY -->

	<changeSet author="devang" id="2013-10-18-01">
		<sql>
			CREATE TABLE TEMPTABLE ( `id` BIGINT(20) NOT NULL AUTO_INCREMENT,
			`username` VARCHAR(50) NOT NULL,
			PRIMARY KEY (`id`)
			)
		</sql>
	</changeSet>
	<changeSet id="2013-10-19-01" author="devang">
		<dropTable tableName="TEMPTABLE" />
	</changeSet>



	<!-- For issue 62 [Allow for entry of donor haemoglobin count] -->
	<changeSet id="201310242025" author="devang">
		<insert tableName="FormField">
			<column name="form" value="CollectedSample"></column>
			<column name="FIELD" value="haemoglobinCount"></column>
			<column name="defaultDisplayName" value="Haemoglobin Count"></column>
			<column name="defaultValue" value=""></column>
			<column name="maxLength" value="0"></column>
			<column name="hidden" value="0"></column>
			<column name="isHidable" value="1"></column>
			<column name="isRequired" value="0"></column>
			<column name="canBeOptional" value="1"></column>
			<column name="autoGenerate" value="0"></column>
			<column name="isAutoGeneratable" value="0"></column>
			<column name="useCurrentTime" value="0"></column>
			<column name="isTimeField" value="0"></column>			
		</insert>
		<update tableName="CollectedSample">
			<column name="haemoglobinCount" type="DECIMAL(7,1)" defaultValue="NULL"></column>
		</update>
		<update tableName="CollectedSample_AUD">
			<column name="haemoglobinCount" type="DECIMAL(7,1)" defaultValue="NULL"></column>
		</update>
	</changeSet>

	<!-- For issue 69 [Allow for entry of donor weight] -->
	<changeSet id="201310241815" author="devang">
		<insert tableName="FormField">
			<column name="form" value="CollectedSample"></column>
			<column name="FIELD" value="donorWeight"></column>
			<column name="defaultDisplayName" value="Donor Weight"></column>
			<column name="defaultValue" value=""></column>
			<column name="maxLength" value="0"></column>
			<column name="hidden" value="0"></column>
			<column name="isHidable" value="1"></column>
			<column name="isRequired" value="0"></column>
			<column name="canBeOptional" value="1"></column>
			<column name="autoGenerate" value="0"></column>
			<column name="isAutoGeneratable" value="0"></column>
			<column name="useCurrentTime" value="0"></column>
			<column name="isTimeField" value="0"></column>			
		</insert>
		<update tableName="CollectedSample">
			<column name="donorWeight" type="DECIMAL(7,1)" defaultValue="NULL"></column>
		</update>
		<update tableName="CollectedSample_AUD">
			<column name="donorWeight" type="DECIMAL(7,1)" defaultValue="NULL"></column>
		</update>
	</changeSet>
	
	<!-- For issue 61 [Add donor blood pressure (systolic & diastolic)] -->
    <changeSet id="201310242001" author="devang">
        <insert tableName="FormField">
            <column name="form" value="CollectedSample"></column>
            <column name="FIELD" value="bloodPressureSystolic"></column>
            <column name="defaultDisplayName" value="Blood Pressure Systolic"></column>
            <column name="defaultValue" value=""></column>
            <column name="maxLength" value="0"></column>
            <column name="hidden" value="0"></column>
            <column name="isHidable" value="1"></column>
            <column name="isRequired" value="0"></column>
            <column name="canBeOptional" value="1"></column>
            <column name="autoGenerate" value="0"></column>
            <column name="isAutoGeneratable" value="0"></column>
            <column name="useCurrentTime" value="0"></column>
            <column name="isTimeField" value="0"></column>                        
        </insert>
        <insert tableName="FormField">
            <column name="form" value="CollectedSample"></column>
            <column name="FIELD" value="bloodPressureDiastolic"></column>
            <column name="defaultDisplayName" value="Blood Pressure Diastolic"></column>
            <column name="defaultValue" value=""></column>
            <column name="maxLength" value="0"></column>
            <column name="hidden" value="0"></column>
            <column name="isHidable" value="1"></column>
            <column name="isRequired" value="0"></column>
            <column name="canBeOptional" value="1"></column>
            <column name="autoGenerate" value="0"></column>
            <column name="isAutoGeneratable" value="0"></column>
            <column name="useCurrentTime" value="0"></column>
            <column name="isTimeField" value="0"></column>                        
        </insert>                        
        <update tableName="CollectedSample">
            <column name="bloodPressure" type="int" defaultValue="NULL"></column>
        </update>
        <renameColumn tableName="CollectedSample" oldColumnName="bloodPressure" newColumnName="bloodPressureSystolic" columnDataType="int"/>
        <update tableName="CollectedSample_AUD">
            <column name="bloodPressure" type="int" defaultValue="NULL"></column>
        </update>
        <renameColumn tableName="CollectedSample_AUD" oldColumnName="bloodPressure" newColumnName="bloodPressureSystolic" columnDataType="int"/>
        <addColumn tableName="CollectedSample">
            <column name="bloodPressureDiastolic" type="int" defaultValue="NULL"></column>
        </addColumn>
        <addColumn tableName="CollectedSample_AUD">
            <column name="bloodPressureDiastolic" type="int" defaultValue="NULL"></column>
        </addColumn>                        
    </changeSet>
	
	<!-- For issue 70 [Allow for entry of donor pulse] -->
	<changeSet id="201310241926" author="devang">
		<insert tableName="FormField">
			<column name="form" value="CollectedSample"></column>
			<column name="FIELD" value="donorPulse"></column>
			<column name="defaultDisplayName" value="Donor Pulse"></column>
			<column name="defaultValue" value=""></column>
			<column name="maxLength" value="0"></column>
			<column name="hidden" value="0"></column>
			<column name="isHidable" value="1"></column>
			<column name="isRequired" value="0"></column>
			<column name="canBeOptional" value="1"></column>
			<column name="autoGenerate" value="0"></column>
			<column name="isAutoGeneratable" value="0"></column>
			<column name="useCurrentTime" value="0"></column>
			<column name="isTimeField" value="0"></column>			
		</insert>
		<addColumn tableName="CollectedSample">
			<column name="donorPulse" type="int" defaultValue="NULL"></column>
		</addColumn>
		<addColumn tableName="CollectedSample_AUD">
			<column name="donorPulse" type="int" defaultValue="NULL"></column>
		</addColumn>		
	</changeSet>

	<!-- For issue 39 [Add in Date of first donation field to Donor form] -->
 	<changeSet id="201310251212" author="ankur">
 		<addColumn tableName="Donor">
 			<column name="dateOfFirstDonation" type="DATE" defaultValue="NULL"></column>
 		</addColumn>
 		<addColumn tableName="Donor_AUD">
 			<column name="dateOfFirstDonation" type="DATE" defaultValue="NULL"></column>
 		</addColumn>		
 		<insert tableName="FormField">
 			<column name="form" value="Donor"></column>
 			<column name="FIELD" value="dateOfFirstDonation"></column>
 			<column name="defaultDisplayName" value="Date of First Donation"></column>
 			<column name="defaultValue" value=""></column>
 			<column name="maxLength" value="0"></column>
 			<column name="hidden" value="0"></column>
 			<column name="isHidable" value="1"></column>
 			<column name="isRequired" value="0"></column>
 			<column name="canBeOptional" value="1"></column>
 			<column name="autoGenerate" value="0"></column>
 			<column name="isAutoGeneratable" value="0"></column>
 			<column name="useCurrentTime" value="0"></column>
 			<column name="isTimeField" value="0"></column>			
 		</insert>
 	</changeSet>

	<!-- For issue 27 [Add 'Record Product' tab to Component Processing] -->
	<changeSet id="201311071844" author="Ankur">
		<addColumn tableName="Product">
			<column name="componentIdentificationNumber" type="VARCHAR(30)" defaultValue=""></column>
		</addColumn>
		<addColumn tableName="Product_AUD">
			<column name="componentIdentificationNumber" type="VARCHAR(30)" defaultValue=""></column>
		</addColumn>
		<insert tableName="FormField">
			<column name="form" value="Product"></column>
			<column name="FIELD" value="componentIdentificationNumber"></column>
			<column name="defaultDisplayName" value="Component Identification Number"></column>
			<column name="defaultValue" value=""></column>
			<column name="maxLength" value="0"></column>
			<column name="hidden" value="0"></column>
			<column name="isHidable" value="1"></column>
			<column name="isRequired" value="0"></column>
			<column name="canBeOptional" value="1"></column>
			<column name="autoGenerate" value="0"></column>
			<column name="isAutoGeneratable" value="0"></column>
			<column name="useCurrentTime" value="0"></column>
			<column name="isTimeField" value="0"></column>			
		</insert>	
		<insert tableName="FormField">
			<column name="form" value="Product"></column>
			<column name="FIELD" value="numUnits"></column>
			<column name="defaultDisplayName" value="Num. Units"></column>
			<column name="defaultValue" value=""></column>
			<column name="maxLength" value="0"></column>
			<column name="hidden" value="0"></column>
			<column name="isHidable" value="1"></column>
			<column name="isRequired" value="0"></column>
			<column name="canBeOptional" value="1"></column>
			<column name="autoGenerate" value="0"></column>
			<column name="isAutoGeneratable" value="0"></column>
			<column name="useCurrentTime" value="0"></column>
			<column name="isTimeField" value="0"></column>			
		</insert>
	</changeSet>
	
	<!-- For issue 102 [Add Request Type 'Bulk Transfer' Flag] -->
	<changeSet id="201311081617" author="devang">
	    <addColumn tableName="RequestType">
	        <column name="bulkTransfer" type="TINYINT(1)"/>
	    </addColumn>
		<addColumn tableName="RequestType_AUD">
	        <column name="bulkTransfer" type="TINYINT(1)"/>
	    </addColumn>
	</changeSet>
	
	<!-- Update FormField table to rename Collection info to Donation -->
	<changeSet id="201311081720" author="danfuterman">
		<update tableName="FormField">
    		<column name="defaultDisplayName" value="Donation Identification Number" />
    		<where>field = "collectionNumber"</where>
		</update>
		<update tableName="FormField">
    		<column name="defaultDisplayName" value="Donation Site" />
    		<where>field = "collectionSite"</where>
		</update>
		<update tableName="FormField">
    		<column name="defaultDisplayName" value="Donation Centre" />
    		<where>field = "collectionCenter"</where>
		</update>
	</changeSet>

	<!-- For issue 104 [Add Lot Release Functionality] -->
    <changeSet id="201311111726" author="devang">
            <insert tableName="GenericConfig">
                    <column name="id" value="48"></column>
                    <column name="propertyName" value="lotRelease"></column>
                    <column name="propertyOwner" value="labsetup"></column>
                    <column name="propertyValue" value="TRUE"></column>
            </insert>
    </changeSet>

    <!-- For issue 95 [Add TTI Test Result import mechanism and UI] -->
     <changeSet id="201311071517" author="devang">
	     <addColumn tableName="BloodTestResult">
	     	<column name="reagentLotNumber" type="varchar(20)" />
	     </addColumn>
	     <insert tableName="GenericConfig">
	     	<column name="id" value="47"></column>
	     	<column name="propertyName" value="ttiUploadResult"></column>
	     	<column name="propertyOwner" value="labsetup"></column>
	     	<column name="propertyValue" value="true"></column>
	     </insert>
   </changeSet>
   
   <!-- For issue 58 [Add ability to update Deferrals] -->
     <changeSet id="201311251517" author="devang">
	     <addColumn tableName="DonorDeferral">
	     	<column name="isVoided" type="tinyint(1)" />
	     	<column name="voidedBy_id" type="smallint(6)" />
	     	<column name="voidedDate" type="date" />
	     </addColumn>
	    <addForeignKeyConstraint constraintName="fk_voidedBy"
			baseTableName="DonorDeferral" baseColumnNames="voidedBy_id"
			referencedTableName="User" referencedColumnNames="id"/>
   </changeSet>
   
    <changeSet id="201311251525" author="devang">
	     <addColumn tableName="DonorDeferral_AUD">
	     	<column name="isVoided" type="tinyint(1)" />
	     	<column name="voidedBy_id" type="smallint(6)" />
	     	<column name="voidedDate" type="date" />
	     </addColumn>
	    <addForeignKeyConstraint constraintName="fk_voidedBy_aud"
			baseTableName="DonorDeferral" baseColumnNames="voidedBy_id"
			referencedTableName="User" referencedColumnNames="id"/>
   </changeSet>

   <!-- For issue 64 [Add isDeleted field to BloodTest and BloodTest_AUD Tables] -->
     <changeSet id="201401140950" author="srikanth">
	     <addColumn tableName="BloodTest">
	     	<column name="isDeleted" type="TINYINT(1)" />
	     </addColumn>
	     
	     <addColumn tableName="BloodTest_AUD">
	     	<column name="isDeleted" type="TINYINT(1)" />
	     </addColumn>
	</changeSet>
   
	<!-- For issue 117 [Configure Role] -->
	<changeSet id="20131129112" author="nikita">
		<addColumn tableName="Role">
			<column name="description" type="longtext"></column>
		</addColumn>
	</changeSet>
	<changeSet id="20131129113" author="nikita">
		<addColumn tableName="Role_AUD">
			<column name="description" type="longtext"></column>
		</addColumn>
	</changeSet>
	
	<!-- For issue 117 [for issue role management] -->
	<changeSet id="201401310210" author="srikanth">
		<insert tableName="FormField">
			<column name="form" value="Role"></column>
			<column name="FIELD" value="name"></column>
			<column name="defaultDisplayName" value="Role Name"></column>
			<column name="defaultValue" value=""></column>
			<column name="maxLength" value="0"></column>
			<column name="hidden" value="0"></column>
			<column name="isHidable" value="1"></column>
			<column name="isRequired" value="1"></column>
			<column name="canBeOptional" value="1"></column>
			<column name="autoGenerate" value="0"></column>
			<column name="isAutoGeneratable" value="0"></column>
			<column name="useCurrentTime" value="0"></column>
			<column name="isTimeField" value="0"></column>			
		</insert>
		</changeSet>
		
	<!-- For issue 118[improve admin UI to manage users ] -->
	<changeSet id="201402030408" author="srikanth">
		<insert tableName="FormField">
			<column name="form" value="user"></column>
			<column name="FIELD" value="username"></column>
			<column name="defaultDisplayName" value="Username"></column>
			<column name="defaultValue" value=""></column>
			<column name="maxLength" value="0"></column>
			<column name="hidden" value="0"></column>
			<column name="isHidable" value="1"></column>
			<column name="isRequired" value="1"></column>
			<column name="canBeOptional" value="1"></column>
			<column name="autoGenerate" value="0"></column>
			<column name="isAutoGeneratable" value="0"></column>
			<column name="useCurrentTime" value="0"></column>
			<column name="isTimeField" value="0"></column>			
		</insert>
	</changeSet>
	
	<!-- For issue 118[improve admin UI to manage users ] -->
	<changeSet id="201402030415" author="srikanth">
		<insert tableName="FormField">
			<column name="form" value="user"></column>
			<column name="FIELD" value="firstName"></column>
			<column name="defaultDisplayName" value="Firstname"></column>
			<column name="defaultValue" value=""></column>
			<column name="maxLength" value="0"></column>
			<column name="hidden" value="0"></column>
			<column name="isHidable" value="1"></column>
			<column name="isRequired" value="0"></column>
			<column name="canBeOptional" value="1"></column>
			<column name="autoGenerate" value="0"></column>
			<column name="isAutoGeneratable" value="0"></column>
			<column name="useCurrentTime" value="0"></column>
			<column name="isTimeField" value="0"></column>			
		</insert>
		
		<insert tableName="FormField">
			<column name="form" value="user"></column>
			<column name="FIELD" value="lastname"></column>
			<column name="defaultDisplayName" value="Lastname"></column>
			<column name="defaultValue" value=""></column>
			<column name="maxLength" value="0"></column>
			<column name="hidden" value="0"></column>
			<column name="isHidable" value="1"></column>
			<column name="isRequired" value="0"></column>
			<column name="canBeOptional" value="1"></column>
			<column name="autoGenerate" value="0"></column>
			<column name="isAutoGeneratable" value="0"></column>
			<column name="useCurrentTime" value="0"></column>
			<column name="isTimeField" value="0"></column>			
		</insert>
		
	</changeSet>
	
	<!-- For issue 134 [Add New Roles And Permissions]  -->
	<changeSet id="201402210359" author="srikanth">
		<delete tableName="User_Role"></delete>
		<delete tableName="Permission_Role"></delete>
		<delete tableName="Role"></delete>
		<delete tableName="Permission"></delete>
		<delete tableName="User"></delete>
	</changeSet>
	

	<!-- For issue 71 [Include additional columns in Donation History table] -->
	<changeSet id="201401151001" author="srikanth">
		<update tableName="FormField">
			<column name="displayName" value="DIN" />
			<where>field = "collectionNumber"</where>
		</update>
		<update tableName="FormField">
			<column name="displayName" value="HGB" />
			<where>field = "haemoglobinCount"</where>
		</update>
		<update tableName="FormField">
			<column name="displayName" value="HR" />
			<where>field = "donorPulse"</where>
		</update>
		<update tableName="FormField">
			<column name="displayName" value="WT" />
			<where>field = "donorWeight"</where>
		</update>

		<insert tableName="FormField">
			<column name="form" value="CollectedSample"></column>
			<column name="FIELD" value="bloodPressure"></column>
			<column name="defaultDisplayName" value="Blood Pressure"></column>
			<column name="defaultValue" value=""></column>
			<column name="maxLength" value="0"></column>
			<column name="hidden" value="0"></column>
			<column name="isHidable" value="1"></column>
			<column name="isRequired" value="0"></column>
			<column name="canBeOptional" value="1"></column>
			<column name="autoGenerate" value="0"></column>
			<column name="isAutoGeneratable" value="0"></column>
			<column name="useCurrentTime" value="0"></column>
			<column name="isTimeField" value="0"></column>	
			<column name="displayName" value="BP"></column>		
		</insert>
  </changeSet>
  
  
  
<!-- For issue 172[Add in additional donor demographic fields] --> 
<changeSet id="201405200258" author="srikanth">

  <createTable  tableName="IdType">
     <column name="id" type="BIGINT" autoIncrement = "true">
           	<constraints primaryKey="true" nullable="false" />
     </column>
     <column name="idType" type="varchar(255)"/> 
      <column name="regExp" type="varchar(255)" defaultValue = "NULL"/>
  </createTable>

  <createTable  tableName="PreferredLanguage">
     <column name="id" type="BIGINT" autoIncrement = "true">
           	<constraints primaryKey="true" nullable="false" />
     </column>
     <column name="preferredLanguage" type="varchar(255)"/> 
  </createTable>


  <dropColumn  columnName="address" tableName="Donor"/>
  <dropColumn  columnName="phoneNumber" tableName="Donor"/>
 


	<addColumn tableName="Donor">
	            <column name="idType_id" type="BIGINT" defaultValue="NULL">
                          <constraints foreignKeyName="Donor_Idtype_FK" references="IdType(id)"/>
	            </column>
	</addColumn>

	
	<addColumn tableName="Donor">
	            <column name="preferredLanguage_id" type="BIGINT" defaultValue="NULL"> </column>
	</addColumn>


	 <addForeignKeyConstraint baseColumnNames="preferredLanguage_id"
	            baseTableName="Donor"
	            constraintName="fk_donor_preferredLanguage"
	            referencedColumnNames="id"
	            referencedTableName="PreferredLanguage"/>




      <!-- For issue 38 [Add Donor Title field] -->
       <addColumn tableName="Donor">
            <column name="title" type="VARCHAR(15)"></column>
        </addColumn>

        <addColumn tableName="Donor_AUD">
            <column name="title" type="VARCHAR(15)" defaultValue="Blank"></column>
        </addColumn>

        <insert tableName="FormField">
            <column name="form" value="Donor"></column>
            <column name="FIELD" value="title"></column>
            <column name="defaultDisplayName" value="Title"></column>
            <column name="defaultValue" value=""></column>
            <column name="maxLength" value="0"></column>
            <column name="hidden" value="0"></column>
            <column name="isHidable" value="0"></column>
            <column name="isRequired" value="0"></column>
            <column name="canBeOptional" value="1"></column>
            <column name="autoGenerate" value="0"></column>
            <column name="isAutoGeneratable" value="0"></column>
            <column name="useCurrentTime" value="0"></column>
            <column name="isTimeField" value="0"></column>
        </insert>
</changeSet>
	<!-- For issue 26 [Add WHO Deferral Reasons] -->
	<changeSet  author="nikita" id = "201310241525">
			<delete tableName="DeferralReason"></delete>
	</changeSet>

<changeSet id="201310241526" author="nikita">
		<sql>
			ALTER TABLE DeferralReason AUTO_INCREMENT=1;
		</sql>
</changeSet>

<!--For Issue #36[Add Donor Codes Functionality] -->
<changeSet id="201405041130" author="srikanth">


       <createTable  tableName="DonorCodeGroup">
          <column name="id" type="BIGINT" autoIncrement = "true">
          	<constraints primaryKey="true" nullable="false" />
          </column>
           <column name="donorCodeGroup" type="varchar(255)"/> 
       </createTable>
     
       <createTable  tableName="DonorCode">
          <column name="id" type="BIGINT" autoIncrement="true">
          	<constraints primaryKey="true" nullable="false" />
         </column>
          <column name="donorCode" type="varchar(255)"/> 
         <column name="donorCodeGroupId" type="BIGINT">
          	<constraints  nullable="false" />
         </column>
      </createTable>
       <addForeignKeyConstraint baseColumnNames="donorCodeGroupId"
                                  baseTableName="DonorCode"
                                  constraintName="fk_DonorCode_DonorCodeGroup"
                                  referencedColumnNames="id"
                                  referencedTableName="DonorCodeGroup"/>

       
      
      <createTable  tableName="DonorDonorCode">
         <column name="id" type="BIGINT" autoIncrement="true">
          	<constraints primaryKey="true" nullable="false" />
         </column>
          <column name="donorId" type="BIGINT">
          	<constraints  nullable="false" />
          </column>
          <column name="donorCodeId" type="BIGINT">
          	<constraints  nullable="false" />
          </column>
          <column name="createdDate" type="TIMESTAMP"/>
          <column name="lastUpdated" type="TIMESTAMP"/>
          <column name="createdBy_id" type="SMALLINT"/>
          <column name="lastUpdatedBy_id" type="SMALLINT"/>
     </createTable>
        <addForeignKeyConstraint baseColumnNames="donorCodeId"
                                  baseTableName="DonorDonorCode"
                                  constraintName="fk_DonorDonorCode_DonorCode"
                                  referencedColumnNames="id"
                                  referencedTableName="DonorCode"/>
        <addForeignKeyConstraint baseColumnNames="donorId"
                                  baseTableName="DonorDonorCode"
                                  constraintName="fk_DonorDonorCode_Donor"
                                  referencedColumnNames="id"
                                  referencedTableName="Donor"/>
   
    <createTable  tableName="DonorDonorCode_AUD">
         <column name="id" type="BIGINT" autoIncrement="true">
          	<constraints primaryKey="true" nullable="false" />
         </column>
          <column name="REV" type="INT">
          	<constraints  primaryKey="true" nullable="false" />
          </column>
          <column name="REVTYPE" type="TINYINT"/>
          <column name="createdDate" type="TIMESTAMP"/>
          <column name="lastUpdated" type="TIMESTAMP"/>
          <column name="createdBy_id" type="SMALLINT"/>
          <column name="lastUpdatedBy_id" type="SMALLINT"/>
    </createTable>

   
     

</changeSet>
<!-- For issue 172[Add in additional donor demographic fields] -->
 <changeSet id ="201405040141" author = "srikanth">
   
     <addColumn tableName="Donor">
			<column name="addressId" type="int" defaultValue="NULL"></column>
     </addColumn>
     <addColumn tableName="Donor">
			<column name="contactId" type="int" defaultValue="NULL"></column>
     </addColumn>
     <addColumn tableName="Donor">
			<column name="idNumber" type="VARCHAR(255)" ></column>
     </addColumn>
     <addColumn tableName="Donor_AUD">
			<column name="idNumber" type="VARCHAR(255)" ></column>
     </addColumn>
    
   <createTable  tableName="AddressType">
       <column name="id" type="BIGINT" autoIncrement = "true">
           	<constraints primaryKey="true" nullable="false" />
       </column>
       <column name="preferredAddressType" type="varchar(255)"/> 
   </createTable>

   <createTable  tableName="Address">
       <column name="id" type="BIGINT" autoIncrement = "true">
           	<constraints primaryKey="true" nullable="false" />
       </column>

       <column name="homeAddressLine1" type="varchar(255)"/> 
       <column name="homeAddressLine2" type="varchar(255)"/> 
       <column name="homeAddressCity" type="varchar(255)"/> 
       <column name="homeAddressProvince" type="varchar(255)"/> 
       <column name="homeAddressDistrict" type="varchar(255)"/> 
       <column name="homeAddressState" type="varchar(255)"/> 
       <column name="homeAddressCountry" type="varchar(255)"/> 
       <column name="homeAddressZipcode" type="varchar(255)"/> 

	    <column name="workAddressLine1" type="varchar(255)"/> 
	    <column name="workAddressLine2" type="varchar(255)"/> 
	    <column name="workAddressCity" type="varchar(255)"/> 
	    <column name="workAddressProvince" type="varchar(255)"/> 
	    <column name="workAddressDistrict" type="varchar(255)"/> 
	    <column name="workAddressCountry" type="varchar(255)"/> 
	    <column name="workAddressState" type="varchar(255)"/> 
	    <column name="workAddressZipcode" type="varchar(255)"/> 


       <column name="postalAddressLine1" type="varchar(255)"/> 
       <column name="postalAddressLine2" type="varchar(255)"/> 
       <column name="postalAddressCity" type="varchar(255)"/> 
       <column name="postalAddressProvince" type="varchar(255)"/> 
       <column name="postalAddressDistrict" type="varchar(255)"/> 
       <column name="postalAddressCountry" type="varchar(255)"/> 
       <column name="postalAddressState" type="varchar(255)"/> 
       <column name="postalAddressZipcode" type="varchar(255)"/> 
      

       
  </createTable>

  <dropForeignKeyConstraint baseTableName="Donor" constraintName="FK3F25E46FCE9E976"/>


 <createTable  tableName="Contact">
       <column name="id" type="BIGINT" autoIncrement = "true">
           	<constraints primaryKey="true" nullable="false" />
       </column>

       <column name="mobileNumber" type="varchar(255)"/> 
       <column name="homeNumber" type="varchar(255)"/> 
       <column name="workNumber" type="varchar(255)"/> 
       <column name="email" type="varchar(255)"/>
  </createTable>

 <dropColumn  columnName="city" tableName="Donor"/>
 <dropColumn  columnName="province" tableName="Donor"/>
 <dropColumn  columnName="district" tableName="Donor"/>
 <dropColumn  columnName="country" tableName="Donor"/>
 <dropColumn  columnName="state" tableName="Donor"/>
 <dropColumn  columnName="zipcode" tableName="Donor"/>
 <dropColumn  columnName="nationalId" tableName="Donor"/>
 <dropColumn  columnName="otherPhoneNumber" tableName="Donor"/>

 <dropColumn  columnName="city" tableName="Donor_AUD"/>
 <dropColumn  columnName="province" tableName="Donor_AUD"/>
 <dropColumn  columnName="district" tableName="Donor_AUD"/>
 <dropColumn  columnName="country" tableName="Donor_AUD"/>
 <dropColumn  columnName="state" tableName="Donor_AUD"/>
 <dropColumn  columnName="zipcode" tableName="Donor_AUD"/>
 <dropColumn  columnName="nationalId" tableName="Donor_AUD"/>
 <dropColumn  columnName="otherPhoneNumber" tableName="Donor_AUD"/>

 <addColumn tableName="Donor">
	<column name="contactMethodType_id" type="SMALLINT(6)">
			  	    <constraints foreignKeyName="Contact_ContactType_FK" references="ContactMethodType(id)"/>
    </column> 
 </addColumn>
 <addColumn tableName="Donor">
	<column name="addressTypeId" type="BIGINT"> 
		 <constraints foreignKeyName="Address_AddressType_fk" references="AddressType(id)"/>
   </column>
 </addColumn>

 
 <insert tableName="FormField">
			<column name="form" value="Donor"></column>
			<column name="FIELD" value="mobileNumber"></column>
			<column name="defaultDisplayName" value="Mobile Number"></column>
			<column name="defaultValue" value=""></column>
			<column name="maxLength" value="0"></column>
			<column name="hidden" value="0"></column>
			<column name="isHidable" value="1"></column>
			<column name="isRequired" value="0"></column>
			<column name="canBeOptional" value="1"></column>
			<column name="autoGenerate" value="0"></column>
			<column name="isAutoGeneratable" value="0"></column>
			<column name="useCurrentTime" value="0"></column>
			<column name="isTimeField" value="0"></column>			
 </insert>
 <insert tableName="FormField">
			<column name="form" value="Donor"></column>
			<column name="FIELD" value="idNumber"></column>
			<column name="defaultDisplayName" value="ID Number"></column>
			<column name="defaultValue" value=""></column>
			<column name="maxLength" value="0"></column>
			<column name="hidden" value="0"></column>
			<column name="isHidable" value="1"></column>
			<column name="isRequired" value="0"></column>
			<column name="canBeOptional" value="1"></column>
			<column name="autoGenerate" value="0"></column>
			<column name="isAutoGeneratable" value="0"></column>
			<column name="useCurrentTime" value="0"></column>
			<column name="isTimeField" value="0"></column>			
 </insert>
<insert tableName="FormField">
			<column name="form" value="Donor"></column>
			<column name="FIELD" value="workNumber"></column>
			<column name="defaultDisplayName" value="Work Number"></column>
			<column name="defaultValue" value=""></column>
			<column name="maxLength" value="0"></column>
			<column name="hidden" value="0"></column>
			<column name="isHidable" value="1"></column>
			<column name="isRequired" value="0"></column>
			<column name="canBeOptional" value="1"></column>
			<column name="autoGenerate" value="0"></column>
			<column name="isAutoGeneratable" value="0"></column>
			<column name="useCurrentTime" value="0"></column>
			<column name="isTimeField" value="0"></column>			
 </insert>

<insert tableName="FormField">
			<column name="form" value="Donor"></column>
			<column name="FIELD" value="callingName"></column>
			<column name="defaultDisplayName" value="Calling Name"></column>
			<column name="defaultValue" value=""></column>
			<column name="maxLength" value="0"></column>
			<column name="hidden" value="0"></column>
			<column name="isHidable" value="1"></column>
			<column name="isRequired" value="0"></column>
			<column name="canBeOptional" value="1"></column>
			<column name="autoGenerate" value="0"></column>
			<column name="isAutoGeneratable" value="0"></column>
			<column name="useCurrentTime" value="0"></column>
			<column name="isTimeField" value="0"></column>			
 </insert>
 <insert tableName="FormField">
			<column name="form" value="Donor"></column>
			<column name="FIELD" value="idType"></column>
			<column name="defaultDisplayName" value="Id Type"></column>
			<column name="defaultValue" value=""></column>
			<column name="maxLength" value="0"></column>
			<column name="hidden" value="0"></column>
			<column name="isHidable" value="1"></column>
			<column name="isRequired" value="0"></column>
			<column name="canBeOptional" value="1"></column>
			<column name="autoGenerate" value="0"></column>
			<column name="isAutoGeneratable" value="0"></column>
			<column name="useCurrentTime" value="0"></column>
			<column name="isTimeField" value="0"></column>			
 </insert>

 <insert tableName="FormField">
			<column name="form" value="Donor"></column>
			<column name="FIELD" value="homeNumber"></column>
			<column name="defaultDisplayName" value="Home Number"></column>
			<column name="defaultValue" value=""></column>
			<column name="maxLength" value="0"></column>
			<column name="hidden" value="0"></column>
			<column name="isHidable" value="1"></column>
			<column name="isRequired" value="0"></column>
			<column name="canBeOptional" value="1"></column>
			<column name="autoGenerate" value="0"></column>
			<column name="isAutoGeneratable" value="0"></column>
			<column name="useCurrentTime" value="0"></column>
			<column name="isTimeField" value="0"></column>			
 </insert>

<insert tableName="FormField">
			<column name="form" value="Donor"></column>
			<column name="FIELD" value="email"></column>
			<column name="defaultDisplayName" value="Email"></column>
			<column name="defaultValue" value=""></column>
			<column name="maxLength" value="0"></column>
			<column name="hidden" value="0"></column>
			<column name="isHidable" value="1"></column>
			<column name="isRequired" value="0"></column>
			<column name="canBeOptional" value="1"></column>
			<column name="autoGenerate" value="0"></column>
			<column name="isAutoGeneratable" value="0"></column>
			<column name="useCurrentTime" value="0"></column>
			<column name="isTimeField" value="0"></column>			
 </insert>
 <insert tableName="FormField">
			<column name="form" value="Donor"></column>
			<column name="FIELD" value="addressLine1"></column>
			<column name="defaultDisplayName" value="Address Line1"></column>
			<column name="defaultValue" value=""></column>
			<column name="maxLength" value="0"></column>
			<column name="hidden" value="0"></column>
			<column name="isHidable" value="1"></column>
			<column name="isRequired" value="0"></column>
			<column name="canBeOptional" value="1"></column>
			<column name="autoGenerate" value="0"></column>
			<column name="isAutoGeneratable" value="0"></column>
			<column name="useCurrentTime" value="0"></column>
			<column name="isTimeField" value="0"></column>			
 </insert>
<insert tableName="FormField">
			<column name="form" value="Donor"></column>
			<column name="FIELD" value="addressLine2"></column>
			<column name="defaultDisplayName" value="Address Line2"></column>
			<column name="defaultValue" value=""></column>
			<column name="maxLength" value="0"></column>
			<column name="hidden" value="0"></column>
			<column name="isHidable" value="1"></column>
			<column name="isRequired" value="0"></column>
			<column name="canBeOptional" value="1"></column>
			<column name="autoGenerate" value="0"></column>
			<column name="isAutoGeneratable" value="0"></column>
			<column name="useCurrentTime" value="0"></column>
			<column name="isTimeField" value="0"></column>			
 </insert>
<insert tableName="FormField">
			<column name="form" value="Donor"></column>
			<column name="FIELD" value="preferredAddressType"></column>
			<column name="defaultDisplayName" value="Preferred Address Type"></column>
			<column name="defaultValue" value=""></column>
			<column name="maxLength" value="0"></column>
			<column name="hidden" value="0"></column>
			<column name="isHidable" value="1"></column>
			<column name="isRequired" value="0"></column>
			<column name="canBeOptional" value="1"></column>
			<column name="autoGenerate" value="0"></column>
			<column name="isAutoGeneratable" value="0"></column>
			<column name="useCurrentTime" value="0"></column>
			<column name="isTimeField" value="0"></column>			
 </insert>
 <insert tableName="FormField">
			<column name="form" value="Donor"></column>
			<column name="FIELD" value="workAddress"></column>
			<column name="defaultDisplayName" value="Work Address"></column>
			<column name="defaultValue" value=""></column>
			<column name="maxLength" value="0"></column>
			<column name="hidden" value="0"></column>
			<column name="isHidable" value="1"></column>
			<column name="isRequired" value="0"></column>
			<column name="canBeOptional" value="1"></column>
			<column name="autoGenerate" value="0"></column>
			<column name="isAutoGeneratable" value="0"></column>
			<column name="useCurrentTime" value="0"></column>
			<column name="isTimeField" value="0"></column>			
 </insert>

  <insert tableName="FormField">
			<column name="form" value="Donor"></column>
			<column name="FIELD" value="homeAddress"></column>
			<column name="defaultDisplayName" value="Home Address"></column>
			<column name="defaultValue" value=""></column>
			<column name="maxLength" value="0"></column>
			<column name="hidden" value="0"></column>
			<column name="isHidable" value="1"></column>
			<column name="isRequired" value="0"></column>
			<column name="canBeOptional" value="1"></column>
			<column name="autoGenerate" value="0"></column>
			<column name="isAutoGeneratable" value="0"></column>
			<column name="useCurrentTime" value="0"></column>
			<column name="isTimeField" value="0"></column>			
 </insert>

 <insert tableName="FormField">
			<column name="form" value="Donor"></column>
			<column name="FIELD" value="postalAddress"></column>
			<column name="defaultDisplayName" value="Postal Address"></column>
			<column name="defaultValue" value=""></column>
			<column name="maxLength" value="0"></column>
			<column name="hidden" value="0"></column>
			<column name="isHidable" value="1"></column>
			<column name="isRequired" value="0"></column>
			<column name="canBeOptional" value="1"></column>
			<column name="autoGenerate" value="0"></column>
			<column name="isAutoGeneratable" value="0"></column>
			<column name="useCurrentTime" value="0"></column>
			<column name="isTimeField" value="0"></column>			
 </insert>
  <insert tableName="FormField">
			<column name="form" value="Donor"></column>
			<column name="FIELD" value="contactMethodType"></column>
			<column name="defaultDisplayName" value="Contact Method Type"></column>
			<column name="defaultValue" value=""></column>
			<column name="maxLength" value="0"></column>
			<column name="hidden" value="0"></column>
			<column name="isHidable" value="1"></column>
			<column name="isRequired" value="0"></column>
			<column name="canBeOptional" value="1"></column>
			<column name="autoGenerate" value="0"></column>
			<column name="isAutoGeneratable" value="0"></column>
			<column name="useCurrentTime" value="0"></column>
			<column name="isTimeField" value="0"></column>			
 </insert>
 <insert tableName="FormField">
			<column name="form" value="Donor"></column>
			<column name="FIELD" value="preferredLanguage"></column>
			<column name="defaultDisplayName" value="Preferred Language"></column>
			<column name="defaultValue" value=""></column>
			<column name="maxLength" value="0"></column>
			<column name="hidden" value="0"></column>
			<column name="isHidable" value="1"></column>
			<column name="isRequired" value="0"></column>
			<column name="canBeOptional" value="1"></column>
			<column name="autoGenerate" value="0"></column>
			<column name="isAutoGeneratable" value="0"></column>
			<column name="useCurrentTime" value="0"></column>
			<column name="isTimeField" value="0"></column>			
 </insert>
 </changeSet>
 
 <!-- Add in 'isClosed' field to collectionBatch tables -->
 <changeSet id="201410281957" author="danfuterman">
	<addColumn tableName="CollectionBatch">
		<column name="isClosed" type="tinyint(1)" defaultValue="0"></column>
	</addColumn>
	<addColumn tableName="CollectionBatch_AUD">
		<column name="isClosed" type="tinyint(1)" defaultValue="0"></column>
	</addColumn>		
 </changeSet>

<!-- For issue 229 [Create testBatch table]  -->
   <changeSet id="201311122005" author="nikita">
    <createTable tableName="TestBatch">
    	<column name="id" type="smallint(6)" autoIncrement="true">
    		<constraints primaryKey="true" nullable="false"/>
    	</column>
    	<column name="batchNumber" type="varchar(20)"></column>
    	<column name="isDeleted" type="tinyint(1)"></column>
    	<column name="createdDate" type="timestamp"></column>
    	<column name="lastUpdated" type="timestamp"></column>
    	<column name="notes" type="longtext"></column>
    	<column name="status" type="varchar(20)"></column>
    	<column name="createdBy_id" type="smallint(6)"></column>
    	<column name="lastUpdatedBy_id" type="smallint(6)"></column>
    </createTable>
    </changeSet>
    <changeSet id="201411140420" author="srikanth">
	    <addColumn tableName="CollectionBatch">
	    	<column name="testBatch_id" type="smallint(6)"></column>
	    </addColumn>
	    <addForeignKeyConstraint constraintName="testBatch_id_FK" 
	    						 referencedTableName="TestBatch" 
	    						 baseColumnNames="testBatch_id" 
	    						 baseTableName="CollectionBatch" 
	    						 referencedColumnNames="id"/>
    </changeSet>
    <changeSet id="201411140425" author="srikanth">
     <addColumn tableName="CollectionBatch_AUD">
	    	<column name="testBatch_id" type="smallint(6)"></column>
	    </addColumn>
	    <addForeignKeyConstraint constraintName="testBatch_id_aud_FK" 
	    						 referencedTableName="TestBatch" 
	    						 baseColumnNames="testBatch_id" 
	    						 baseTableName="CollectionBatch_AUD" 
	    						 referencedColumnNames="id"/>
    </changeSet>
    <changeSet id="201311130733" author="srikanth">
    <createTable tableName="TestBatch_AUD">
    	<column name="id" type="smallint(6)">
    		<constraints primaryKey="true" nullable="false"/>
    	</column>
    	<column name="batchNumber" type="varchar(20)"></column>
    	<column name="isDeleted" type="tinyint(1)"></column>
    	<column name="createdDate" type="timestamp"></column>
    	<column name="lastUpdated" type="timestamp"></column>
    	<column name="notes" type="longtext"></column>
    	<column name="status" type="varchar(20)"></column>
    	<column name="createdBy_id" type="smallint(6)"></column>
    	<column name="lastUpdatedBy_id" type="smallint(6)"></column>
    	<column name="REV" type="INT">
          	<constraints  primaryKey="true" nullable="false" />
        </column>
    	<column name="REVTYPE" type="tinyint(4)"></column>
    </createTable>
    </changeSet>


 <!-- For issue 57 [Add WHO Product Discard Reasons] -->
<changeSet author="nikita" id = "2014-11-17-12">
		<delete tableName="ProductStatusChangeReason">
			<where>category='DISCARDED'</where>
	 </delete>
</changeSet>
</databaseChangeLog>	
