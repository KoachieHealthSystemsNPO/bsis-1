<databaseChangeLog xmlns="http://www.liquibase.org/xml/ns/dbchangelog"
  xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:ext="http://www.liquibase.org/xml/ns/dbchangelog-ext"
  xsi:schemaPackType="http://www.liquibase.org/xml/ns/dbchangelog http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-2.0.xsd http://www.liquibase.org/xml/ns/dbchangelog-ext http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-ext.xsd">

  <changeSet id="20170117-1533" author="jmuzinda">
    <!-- Add tracking fields to PackType -->
    <addColumn tableName="PackType">
      <column name="createdDate" type="TIMESTAMP" />
      <column name="createdBy_id" type="BIGINT(20)">
        <constraints foreignKeyName="fk_PackType_createdBy" references="User(id)" />    
      </column>
      <column name="lastUpdated" type="TIMESTAMP" />
      <column name="lastUpdatedBy_id" type="BIGINT(20)">
        <constraints foreignKeyName="fk_PackType_lastUpdatedBy" references="User(id)" />       
      </column>
    </addColumn>
  </changeSet>

  <changeSet id="20170117-1534" author="jmuzinda">
    <!-- Add tracking fields to PackType_AUD -->
    <addColumn tableName="PackType_AUD">
      <column name="createdDate" type="TIMESTAMP" />
      <column name="createdBy_id" type="BIGINT(20)">
      </column>
      <column name="lastUpdated" type="TIMESTAMP" />
      <column name="lastUpdatedBy_id" type="BIGINT(20)">
      </column>
    </addColumn>
  </changeSet>

  <changeSet id="20170117-1535" author="jmuzinda">
    <comment>Update tracking fields</comment>
    <update tableName="PackType">
      <column name="createdDate" valueComputed="CURRENT_TIMESTAMP" />
      <column name="createdBy_id" valueNumeric="1" />
      <column name="lastUpdated" valueComputed="CURRENT_TIMESTAMP" />
      <column name="lastUpdatedBy_id" valueNumeric="1" />
    </update>
    <update tableName="PackType_AUD">
      <column name="createdDate" valueComputed="CURRENT_TIMESTAMP" />
      <column name="createdBy_id" valueNumeric="1" />
      <column name="lastUpdated" valueComputed="CURRENT_TIMESTAMP" />
      <column name="lastUpdatedBy_id" valueNumeric="1" />
    </update>
  </changeSet>
  
  <changeSet id="20170117-1536" author="jmuzinda">
    <comment>Make tracking columns on PackType not nullable</comment>
    <addNotNullConstraint tableName="PackType" columnName="createdDate" columnDataType="TIMESTAMP" />
    <addNotNullConstraint tableName="PackType" columnName="createdBy_id" columnDataType="BIGINT(20)" />
    <addNotNullConstraint tableName="PackType" columnName="lastUpdated" columnDataType="TIMESTAMP" />
    <addNotNullConstraint tableName="PackType" columnName="lastUpdatedBy_id" columnDataType="BIGINT(20)" />
  </changeSet>
</databaseChangeLog>
